<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Redis subscribe SSE test</title>

    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"
    />
  </head>
  <body>
    <h1>test html</h1>
    <div id="messages"></div>

    <script type="text/javascript">
      // eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2MWNkMTExZDgwMGM2NTRiN2NkMTBhYzgiLCJpYXQiOjE2NDA4MzcxNzIsImV4cCI6MTY0MjEwMDAwMH0.fejbuB91OfF7kLFhBzodnGDgZMkVHiqzjJQw0Mx47CI
      document.cookie =
        'accessToken=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOiI2MWNkMTExZDgwMGM2NTRiN2NkMTBhYzciLCJpYXQiOjE2NDA4MzcxNzIsImV4cCI6MTY0MjEwMDAwMH0.pxlBu6JD1r4uweufDCNaUJ0Qg0QU6Jim_FLgFxao5mc'
      const eventSource = new EventSource('/notifications/v1/streaming')

      function updateMessage (message) {
        const list = document.getElementById('messages')
        const item = document.createElement('p')
        item.textContent = message
        list.appendChild(item)
      }

      eventSource.onmessage = function (event) {
        updateMessage(event.data)
      }

      eventSource.onerror = function () {
        updateMessage('Server closed connection')
        eventSource.close()
      }
    </script>
  </body>
</html>
